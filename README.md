# Анализатор Nginx логов

Программа анализирует лог-файлы Nginx, собирая статистику по ним. На вход принимается путь к лог-файлам (локальный путь или URL) и набор параметров для фильтрации и форматирования результатов.

---

## Параметры запуска программы

### Основной параметр
- **--path**: путь к лог-файлам. Может быть локальным шаблоном или URL.

  Примеры:
    - `--path logs\**\2024-08-31.txt`
    - `--path logs\2024*`
    - `--path logs\log.txt`
    - `--path logs\2024*\*.txt`
    - `--path https://raw.githubusercontent.com/elastic/examples/master/Common%20Data%20Formats/nginx_logs/nginx_logs`

### Опциональные параметры
- **--from** и **--to**: задают временной диапазон для анализа логов. Дата указывается в формате `YYYY-MM-DDThh:mm:ssZ`.

  Примеры:
    - `--from 2015-05-17T08:05:01Z --to 2015-05-17T08:12:09Z`
    - `--from 2017-01-12T08:09:15Z`
    - `--to 2011-01-12T02:16:16Z`

- **--format**: задает формат выходного файла со статистикой. Поддерживаются форматы `markdown` (по умолчанию) и `adoc`.

  Примеры:
    - `--format adoc`
    - `--format markdown`

- **--filter-field** и **--filter-value**: фильтрация логов по заданному полю и значению.

  Доступные поля для фильтрации:
    - `remoteAddr` — сравнивает на идентичность с адресом клиента в логе.
    - `remoteUser` — сравнивает на идентичность с пользователем в логе.
    - `requestMethod` — сравнивает на идентичность с методом запроса в логе.
    - `requestPath` — сравнивает, является ли значение фильтрации частью пути запроса в логе.
    - `requestProtocol` — сравнивает на идентичность с протоколом в логе
    - `status` — сравнивает на идентичность с кодом ответа сервера в логе
    - `bytes` — сравнивает на идентичность с размером ответа сервера в логе
    - `referer` — сравнивает, является ли значение фильтрации частью URL страницы, с которой был совершен переход.
    - `agent` — сравнивает, является ли значение фильтрации частью user-agent лога.
    - `date` — сравнивает на идентичность с датой лога.

---

## Функционал программы

1. Выводит источник логов, используемый для анализа.
2. Выводит начальную и конечную дату (по параметрам `--from` и `--to`).
3. Выводит общее количество обработанных запросов.
4. Рассчитывает средний размер ответа сервера.
5. Определяет 95-й перцентиль размера ответа.
6. Находит наиболее часто запрашиваемые ресурсы.
7. Определяет самые частые HTTP-методы.
8. Выводит статистику по кодам ответа сервера.
9. Определяет самые активные часы работы.

---

## Примеры запуска программы

1. `--path C:\Users\User\**\*short.txt --format adoc --from 2015-05-05T08:05:01Z`
2. `--path https://raw.githubusercontent.com/elastic/examples/master/Common%20Data%20Formats/nginx_logs/nginx_logs --format adoc`
3. `--path C:\Users\User\logs\log.txt --filter-field status --filter-value 404`


Пример работы программы:

1. Аргументы при запуске программы:
   `--path https://raw.githubusercontent.com/elastic/examples/master/Common%20Data%20Formats/nginx_logs/nginx_logs --format markdown --filter-field requestMethod --filter-value GET --from 2015-05-17T08:05:57Z --to 2015-05-21T08:05:34Z`
2. Результат работы программы:

#### Общая информация

|        Метрика        |     Значение |
|:---------------:|-----------:|
|       Источник логов        | `https://raw.githubusercontent.com/elastic/examples/master/Common%20Data%20Formats/nginx_logs/nginx_logs` |
|    Начальная дата     |   17.05.2015 |
|     Конечная дата     |   21.05.2015 |
|  Количество запросов  |       11 380 |
| Средний размер ответа |         624404b |
|   95p размера ответа  |         1768b |

#### Самые запрашиваемые ресурсы

|     Ресурс      | Количество |
|:---------------:|-----------:|
|  `/downloads/product_1`  |      6 570 |
|  `/downloads/product_2`  |      4 794 |
|  `/downloads/product_3`  |      16 |

#### Самые запрашиваемые методы

|     Метод      | Количество |
|:---------------:|-----------:|
|  `GET`  |      11 380 |

#### Коды ответа

| Код |          Имя          | Количество |
|:---:|:---------------------:|-----------:|
| 404 | Not Found            | 7 606 |
| 304 | Not Modified         | 2 884 |
| 200 | Ok                   | 843 |
#### Самое активное время

|     Час      | Количество |
|:---------------:|-----------:|
|  `14`  |      497 |
|  `22`  |      490 |
|  `15`  |      490 |





